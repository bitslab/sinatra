(window.webpackJsonp=window.webpackJsonp||[]).push([[188],{"/Nu6":function(e,t,s){"use strict";var a=s("ERkP"),i=s.n(a),n=s("MWbm"),r=s("WXWl"),o=s("t62R"),l=s("MAI/"),c=s("I4+6"),u=s("cm6r"),m=s("rHpw");const p=m.a.create((e=>({root:{backgroundColor:e.colors.primary,borderRadius:e.borderRadii.infinite,boxShadow:e.boxShadows.small,justifyContent:"center",paddingVertical:e.spaces.space4,paddingHorizontal:e.spaces.space16},facepiles:{marginLeft:e.spaces.space4,marginRight:e.spaces.space2},icon:{alignSelf:"center",color:e.colors.whiteOnColor},pillContent:{flexDirection:"row"},pillText:{marginLeft:e.spaces.space4,alignSelf:"center"}})));t.a=function(e){const{label:t,onClick:s,onImpression:a,userAvatarUrls:h}=e;i.a.useEffect((()=>{null==a||a()}),[]);const w=c.a.generate({backgroundColor:m.a.theme.colors.primary,color:m.a.theme.colors.whiteOnColor});return i.a.createElement(n.a,{accessibilityRole:"status"},i.a.createElement(u.a,{interactiveStyles:w,onClick:s,style:p.root},i.a.createElement(n.a,{style:p.pillContent},i.a.createElement(r.a,{style:p.icon}),h&&h.length>0?i.a.createElement(n.a,{style:p.facepiles,testID:"userAvatars"},i.a.createElement(l.a,{borderColor:"primary",userAvatarSize:"large",userAvatarUrls:h})):null,i.a.createElement(o.b,{color:"whiteOnColor",style:p.pillText},t))))}},WXWl:function(e,t,s){"use strict";var a=s("ERkP"),i=s.n(a),n=s("k/Ka"),r=s("Lsrn");const o=(e={})=>Object(n.a)("svg",{...e,accessibilityHidden:void 0===e.accessibilityLabel,style:[r.a.root,e.style],viewBox:"0 0 24 24"},i.a.createElement("g",null,i.a.createElement("path",{d:"M18.707 10.293l-6-6c-.39-.39-1.023-.39-1.414 0l-6 6c-.39.39-.39 1.023 0 1.414.195.195.45.293.707.293s.512-.098.707-.293L11 7.414V20c0 .553.447 1 1 1s1-.447 1-1V7.414l4.293 4.293c.195.195.45.293.707.293s.512-.098.707-.293c.39-.39.39-1.023 0-1.414z"})));o.metadata={width:24,height:24},t.a=o},cjo7:function(e,t,s){"use strict";s.r(t),s.d(t,"NewTweetsPillv2",(function(){return x}));s("kYxP");var a=s("ERkP"),i=s.n(a),n=s("MWbm"),r=s("tLTi"),o=s("/Nu6"),l=s("rHpw"),c=s("qqsb"),u=s.n(c),m=s("fs1G"),p=s("FGLp"),h=s("IbOt"),w=s("v6aA"),d=s("hqKg"),_=s("lnti"),b=s("o52z"),y=s("rxPX"),g=s("G6rE");const f=Object.freeze({}),T=(e,{alert:t})=>t&&t.userIds||Object(b.a)(),S=(e,{module:t})=>(null==t?void 0:t.selectNewTweetsBar(e))||f;var v=Object(y.a)().propsFromState((()=>({userImageUrls:Object(d.createSelector)(g.e.selectAll,T,((e,t)=>t?Object(_.a)(t.map((t=>{const s=e[t];return s?s.profile_image_url_https:void 0}))):[])),newTweetsBar:S}))).withAnalytics({component:"new_tweet_prompt"});const D=u.a.gdb8bdcc,C=u.a.ac0f6492,k={};function x(e){const{alert:t,analytics:s,applyNewTweetsBarInstructions:a,label:l,newTweetsBar:c,remainVisibleInterval:u,removeAlert:d,timelineId:_,triggerDelay:b,unreadCount:y,userImageUrls:g}=e,{featureSwitches:f}=i.a.useContext(w.a),[T,S]=i.a.useState(!1),v=i.a.useRef(),D=i.a.useRef(),x=i.a.useRef(),I=i.a.useRef(t),E=i.a.useRef(_),R=i.a.useRef(d),O=f.getNumberValue("responsive_web_home_sticky_new_tweets_pill_delay_seconds",1),L=f.isTrue("responsive_web_home_sticky_new_tweets_pill_enabled"),j=f.getNumberValue("responsive_web_home_sticky_new_tweets_pill_duration_seconds",-1);Object(p.a)((()=>(P()||V(_),W(),x.current=Object(h.a)({onUp:m.a,onDown:z}),()=>{D.current&&clearTimeout(D.current),v.current&&clearTimeout(v.current),T&&(V(_),null==d||d()),null==x.current||x.current()})));const M=i.a.useCallback((e=>{s.scribeAction(e)}),[s]),P=i.a.useCallback((()=>k[_]),[_]),N=i.a.useCallback((()=>{const e=L&&O>0?1e3*O:t&&t.triggerDelayMs||c&&Math.floor((c.lastRevealedTimestamp||0)/1e3)||b;return P()+e-Date.now()}),[t,O,L,P,c,b]),V=i.a.useCallback((e=>{e&&(k[e]=Date.now())}),[]),U=i.a.useCallback((()=>{V(_),S(!1),t&&setTimeout((()=>d&&d()),500)}),[t,V,d,_]),W=i.a.useCallback((()=>{if(D.current&&(clearTimeout(D.current),D.current=null),t&&!T||c.count>0&&!T||y>0){const e=N();e<=0?(S(!0),k[_]=Date.now(),M("show"),L&&j>0&&(v.current=setTimeout(U,1e3*j))):D.current=setTimeout(W,e)}}),[t,N,U,L,c,M,T,j,_,y]),z=()=>{if(t&&T&&L)return;let e=u;t&&t.displayDurationMs&&t.displayDurationMs>-1&&(e=t.displayDurationMs),T&&Date.now()>=k[_]+e&&(M("dismiss"),U())};i.a.useEffect((()=>{const e=E.current!==_,s=e&&!P();e?(s&&V(_),T&&V(_),null==R.current||R.current(),S(!1),W()):(t||c.count>0)&&!T||y>0?(W(),S(!1)):!I.current&&0!==y||t||U()}),[t,P,U,_,V,y]);const H=(null==t?void 0:t.richText)&&i.a.createElement(r.a,{entities:t.richText.entities,text:t.richText.text});return i.a.createElement(n.a,{accessibilityLabel:C,style:[A.pill,T&&A.show],testID:"pill-container"},i.a.createElement(o.a,{label:H||l,onClick:()=>{M("click"),window.scrollTo(0,0),null==a||a(),U()},userAvatarUrls:g}))}x.defaultProps={isAtNewest:!0,label:D,remainVisibleInterval:3e3,triggerDelay:24e4,unreadCount:0};const A=l.a.create((e=>({pill:{opacity:0,transform:[{translate3d:"0, 0, 0"}],transitionProperty:"transform, opacity",transitionDuration:"0.15s",transitionTimingFunction:"ease, ease, step-end"},show:{opacity:1,transitionTimingFunction:"ease, ease, step-start",transform:[{translate3d:"0, 3.5em, 0"}]}})));t.default=v(x)},o52z:function(e,t,s){"use strict";s.d(t,"a",(function(){return i}));var a=s("VPAj");const i=Object(a.a)([]);Object(a.a)({})},xAHt:function(e,t,s){"use strict";s.r(t),s.d(t,"NewTweetsPill",(function(){return I}));s("kYxP");var a=s("ERkP"),i=s.n(a),n=s("MWbm"),r=s("I4+6"),o=s("rHpw"),l=s("cm6r"),c=s("MAI/"),u=s("t62R"),m=s("qqsb"),p=s.n(m),h=s("WXWl"),w=s("fs1G"),d=s("rcen"),_=s("IbOt"),b=s("v6aA"),y=s("hqKg"),g=s("lnti"),f=s("o52z"),T=s("rxPX"),S=s("G6rE");const v=(e,t)=>t.alert&&t.alert.userIds||Object(f.a)();var D=Object(T.a)().propsFromState((()=>({userImageUrls:Object(y.createSelector)(S.e.selectAll,v,((e,t)=>t?Object(g.a)(t.map((t=>{const s=e[t];return s?s.profile_image_url_https:void 0}))):[]))}))).withAnalytics({component:"new_tweet_prompt"});const C=p.a.gdb8bdcc,k=p.a.ac0f6492,x={},A={};class I extends i.a.PureComponent{constructor(...e){super(...e),this.state={show:!1},this._getLastShownTime=()=>A[this.props.timelineId],this._hide=()=>{const{alert:e,removeAlert:t,timelineId:s}=this.props;this._mounted&&(this._updateLastShownTime(s),this.setState({show:!1})),e&&setTimeout((()=>t()),500)},this._attemptShow=()=>{const{featureSwitches:e}=this.context,{alert:t,isAtNewest:s,removeAlert:a,timelineId:i,unreadCount:n}=this.props;if(this._attemptShowTimeout&&(clearTimeout(this._attemptShowTimeout),this._attemptShowTimeout=null),this._mounted&&(t||n>0)){const n=this._getDelayRemaining();if(n<=0){if(t&&s())return void a();this.setState({show:!0}),x[i]=Date.now(),this._scribeAction("show");const n=e.isTrue("responsive_web_home_sticky_new_tweets_pill_enabled"),r=e.getNumberValue("responsive_web_home_sticky_new_tweets_pill_duration_seconds",-1);n&&r>0&&(this._autoDismissTimeout=setTimeout(this._hide,1e3*r))}else this._attemptShowTimeout=setTimeout(this._attemptShow,n)}},this._handleScrollDown=()=>{const{featureSwitches:e}=this.context,{alert:t,remainVisibleInterval:s,timelineId:a}=this.props;if(t&&this.state.show&&e.isTrue("responsive_web_home_sticky_new_tweets_pill_enabled"))return;let i=s;t&&t.displayDurationMs&&t.displayDurationMs>-1&&(i=t.displayDurationMs),this.state.show&&Date.now()>=x[a]+i&&(this._scribeAction("dismiss"),this._hide())},this._handleClick=()=>{const{applyNewTweetsBarInstructions:e}=this.props;this._scribeAction("click"),window.scrollTo(0,0),null==e||e(),this._hide()}}componentDidMount(){this._mounted=!0,this._getLastShownTime()||this._updateLastShownTime(this.props.timelineId),this._attemptShow(),this._cancelMomentum=Object(_.a)({onUp:w.a,onDown:this._handleScrollDown})}componentDidUpdate(e,t){const{alert:s,timelineId:a,unreadCount:i}=this.props,n=e.timelineId!==a,r=n&&!this._getLastShownTime();n?(r&&this._updateLastShownTime(a),t.show&&this._updateLastShownTime(e.timelineId),null==e.removeAlert||e.removeAlert(),this.setState({show:!1}),this._attemptShow()):((s&&!t.show||i>e.unreadCount)&&this._attemptShow(),!e.alert&&0!==i||s||this._hide())}componentWillUnmount(){const{removeAlert:e,timelineId:t}=this.props;this._mounted=!1,this._attemptShowTimeout&&clearTimeout(this._attemptShowTimeout),this._autoDismissTimeout&&clearTimeout(this._autoDismissTimeout),this.state.show&&(this._updateLastShownTime(t),null==e||e()),this._cancelMomentum()}render(){const{alert:e,label:t,userImageUrls:s}=this.props,{show:a}=this.state;let m;m=e?e.richText&&i.a.createElement(d.a,{entities:e.richText.entities,text:e.richText.text}):t;const p=r.a.generate({backgroundColor:o.a.theme.colors.primary,color:o.a.theme.colors.whiteOnColor});return i.a.createElement(n.a,{accessibilityRole:"status"},i.a.createElement(l.a,{accessibilityHidden:!a,accessibilityLabel:k,accessibilityRole:"button",interactiveStyles:p,onClick:this._handleClick,style:[E.pill,a&&E.show]},i.a.createElement(n.a,{style:E.innerPill},i.a.createElement(h.a,{style:E.icon}),s&&s.length>0?i.a.createElement(n.a,{style:E.facepile},i.a.createElement(c.a,{borderColor:"primary",userAvatarSize:"large",userAvatarUrls:s})):null,i.a.createElement(u.b,{color:"whiteOnColor",numberOfLines:1,style:E.pillText},m))))}_getDelayRemaining(){const{featureSwitches:e}=this.context,{alert:t,triggerDelay:s}=this.props,a=e.getNumberValue("responsive_web_home_sticky_new_tweets_pill_delay_seconds",1),i=e.isTrue("responsive_web_home_sticky_new_tweets_pill_enabled")&&a>0?1e3*a:t&&t.triggerDelayMs||s;return this._getLastShownTime()+i-Date.now()}_updateLastShownTime(e){e&&(A[e]=Date.now())}_scribeAction(e){const{analytics:t}=this.props;t.scribeAction(e)}}I.contextType=b.a,I.defaultProps={isAtNewest:()=>!0,label:C,remainVisibleInterval:3e3,triggerDelay:24e4,unreadCount:0};const E=o.a.create((e=>({pill:{boxShadow:e.boxShadows.small,backgroundColor:e.colors.primary,borderRadius:e.borderRadii.infinite,paddingHorizontal:e.spaces.space16,opacity:0,justifyContent:"center",transform:[{translate3d:"0, 0, 0"}],transitionProperty:"transform, opacity",transitionDuration:"0.15s",transitionTimingFunction:"ease, ease, step-end"},innerPill:{flexDirection:"row",paddingVertical:e.spaces.space4},icon:{width:e.spaces.space20,marginRight:e.spaces.space4,alignSelf:"center",color:e.colors.whiteOnColor},facepile:{marginRight:e.spaces.space8},pillText:{alignSelf:"center"},show:{opacity:1,transitionTimingFunction:"ease, ease, step-start",transform:[{translate3d:"0, 3.5em, 0"}]}}))),R=D(I);t.default=R}}]);
//# sourceMappingURL=https://ton.local.twitter.com/responsive-web-internal/sourcemaps/client-web/loader.NewTweetsPill.dbfefc78.js.map